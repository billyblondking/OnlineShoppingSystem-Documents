# 技术实现方面的一些细节

<!-- TOC -->

- [技术实现方面的一些细节](#%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0%E6%96%B9%E9%9D%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82)
    - [登录相关的 session 属性](#%E7%99%BB%E5%BD%95%E7%9B%B8%E5%85%B3%E7%9A%84-session-%E5%B1%9E%E6%80%A7)
        - [属性名与默认值](#%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%8E%E9%BB%98%E8%AE%A4%E5%80%BC)
        - [登录成功后新值](#%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F%E5%90%8E%E6%96%B0%E5%80%BC)
        - [如何使用 session 属性](#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-session-%E5%B1%9E%E6%80%A7)

<!-- /TOC -->

## 登录相关的 session 属性

### 属性名与默认值

```
//管理员相关
1. adminLoginStatus = false      
1. adminId = ..                    // adminLoginStatus = false 时无意义 

//用户相关
1. userLoginStatus = false
1. shopHasOpend = false             // userLoginStatus = false 时无意义
1. username = ..                    // userLoginStatus = false 时无意义
1. registrationId = ..              // shopHasOpend = false 时无意义
```

### 登录成功后新值

```
//管理员相关
1. adminLoginStatus = true     
1. adminId = ..                    // 实际 id 

//用户相关
1. userLoginStatus = true      
1. shopHasOpend = true         //若该用户已开店   
1. username = ..               //实际用户名
1. registrationId = ..         //shopHasOpend = false 时无意义
```

### 如何使用 session 属性

- JSP 页面中读取 session 属性

```html
<script type="text/javascript">
    <!-- EL 表达式 -->
    var login = "${sessionScope.userLoginStatus}";

    if (login.match("true") != null) {
        $("#unlogin").hide();
        $("#login").show();
        $("#username").html("${sessionScope.username}<b class='caret'></b>"); 
    } else {
        $("#login").hide();
        $("#unlogin").show();
    }
</script>
```

- Tips: 
    1. 独立的 JS 文件无法直接读取 session 属性，所以要想在 JS 代码中使用这些属性的话，需要将这些属性写到 JSP 页面上，然后 在 JS 文件中获取对应元素中的值，示例如下。
    1. 如果页面中没有合适的位置存放该属性值，那么可以在 JSP 页面中添加一个不显示的 `<p></p>` 标签，示例如下。 

```js
var username = $("#username").html()
```

```html
<p id="registrationId" style='display:none'></p>
```